{% load static %}
{% load humanize %}
{% load comment_tags %}

<div id="{{ comment.pk }}" 
     class="card mb-2 {% if forloop.first and comment.parent == -1 %}border-dark{% endif %}"
     style="margin-left: {{comment.layer | multiply:3}}vw">
    {% if forloop.first and comment.parent == -1 %}
        <div class="card-header text-white bg-dark py-2 px-3">{{ thread.title }}</div>
    {% endif %}
    <div class="card-body p-3">
        <div class="row">
            <div class="col-12">
                <div class="row mb-3">
                    <div class="col-6">
                        <strong class="text-muted">{{ comment.created_by.username }}</strong>
                    </div>
                    <div class="col-6 text-right">
                        <small class="text-muted">{{ comment.created_at|naturaltime }}</small>
                    </div>
                </div>
                {{ comment.text }}
                {% if comment.created_by == user %}
                    <div class="mt-3">
                        <a href="{% url 'edit_comment' comment.thread.board.pk comment.thread.pk comment.pk %}" 
                        class="btn btn-primary btn-sm" 
                        role="button">Edit</a>
                    </div>
                {% else %}
                    {% if comment.is_master == False %}
                        <div class="mt-3">
                            <a href="{% url 'reply_comment' comment.thread.board.pk comment.thread.pk comment.pk %}" 
                            class="btn btn-primary btn-sm" 
                            role="button">Reply</a>
                        </div>
                    {% endif %}
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% if comment.children|length > 0 %}
    {% for child in comment.children %}
        {% include "includes/comment_card.html" with comment=child %}
    {% endfor %}
{% endif %}